# Kestrel

<div align="center">

**ä¸‹ä¸€ä»£ç«¯ä¾§è¡Œä¸ºæ£€æµ‹å¼•æ“**

[![Build Status](https://img.shields.io/github/actions/workflow/status/kestrel-detection/kestrel/ci.yml?branch=main)](https://github.com/kestrel-detection/kestrel/actions)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Rust Version](https://img.shields.io/badge/Rust-1.82+-orange.svg)](https://www.rust-lang.org)
[![Phase](https://img.shields.io/badge/Phase-5.6-partial-yellow)](https://github.com/kestrel-detection/kestrel/releases)

**English | [ä¸­æ–‡](README_CN.md)**

Rust + eBPF + Hostæ‰§è¡ŒNFA + Wasm/LuaJITåŒè¿è¡Œæ—¶ + EQLå…¼å®¹å­é›†

é¢å‘ï¼šLinux ä¸ HarmonyOSï¼ˆç±»Unixå¯ç§»æ¤ï¼‰ï¼Œç«¯ä¾§ä½åŠŸè€—å®æ—¶æ£€æµ‹/é˜»æ–­ + ç¦»çº¿å¯å¤ç°å›æ”¾

</div>

---

## ç›®å½•

- [ä¸ºä»€ä¹ˆé€‰æ‹© Kestrelï¼Ÿ](#ä¸ºä»€ä¹ˆé€‰æ‹©-kestrel)
- [ç‰¹æ€§](#ç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [æ¶æ„](#æ¶æ„)
- [è§„åˆ™ç¤ºä¾‹](#è§„åˆ™ç¤ºä¾‹)
- [æ€§èƒ½åŸºå‡†](#æ€§èƒ½åŸºå‡†)
- [é¡¹ç›®è§„æ¨¡](#é¡¹ç›®è§„æ¨¡)
- [æ–‡æ¡£](#æ–‡æ¡£)
- [è·¯çº¿å›¾](#è·¯çº¿å›¾)
- [è´¡çŒ®](#è´¡çŒ®)
- [è®¸å¯è¯](#è®¸å¯è¯)

---

## ä¸ºä»€ä¹ˆé€‰æ‹© Kestrelï¼Ÿ

Kestrel æ˜¯ä¸€ä¸ªä¸“ä¸ºç«¯ä¾§å®‰å…¨æ£€æµ‹è®¾è®¡çš„ä¸‹ä¸€ä»£å¼•æ“ï¼Œåœ¨ä¿æŒé«˜æ€§èƒ½çš„åŒæ—¶æä¾›ç‹¬ç‰¹çš„æ¶æ„ä¼˜åŠ¿ï¼š

### æ ¸å¿ƒå·®å¼‚åŒ–

| ç‰¹æ€§ | ä¼ ç»Ÿæ–¹æ¡ˆ | Kestrel |
|------|----------|---------|
| **è§„åˆ™æ‰§è¡Œ** | è§£é‡Šå‹/è„šæœ¬ | ç¼–è¯‘ä¸º Wasm/LuaJITï¼Œæ€§èƒ½å¯æ§ |
| **äº‹ä»¶é‡‡é›†** | è½®è¯¢/å®¡è®¡ | eBPF kernel-level é‡‡é›†ï¼Œé›¶æ‹·è´ |
| **åºåˆ—æ£€æµ‹** | ç®€å•æ¨¡å¼åŒ¹é… | Host NFA + çŠ¶æ€æœºï¼Œå¤æ‚åºåˆ—æ”¯æŒ |
| **ç¦»çº¿åˆ†æ** | å¯¼å‡ºåˆ° SIEM | åŸç”Ÿæ”¯æŒç¦»çº¿å›æ”¾ï¼Œ100% å¯å¤ç° |
| **è·¨å¹³å°** | ä¾èµ–ç‰¹å®šç»„ä»¶ | æ¶æ„å¯ç§»æ¤ï¼Œé€‚é… Linux/Harmony |

### é€‚ç”¨åœºæ™¯

- **ç«¯ä¾§ EDR**: ç¬”è®°æœ¬/æœåŠ¡å™¨çš„å®æ—¶å¨èƒæ£€æµ‹
- **åº”ç”¨ç™½åå•**: å…³é”®ç³»ç»Ÿçš„è¡Œä¸ºæ§åˆ¶
- **å¨èƒç‹©çŒ**: æœ¬åœ°å¿«é€Ÿæ£€æµ‹ï¼Œæ— éœ€ä¸Šä¼ æ—¥å¿—
- **å®‰å…¨ç ”ç©¶**: å¯å¤ç°çš„ç¦»çº¿åˆ†æç¯å¢ƒ

---

## ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒèƒ½åŠ›

- **ç»Ÿä¸€äº‹ä»¶æµ**: eBPF/å®¡è®¡/ç”¨æˆ·æ€ API ç»Ÿä¸€ä¸ºå¼ºç±»å‹äº‹ä»¶æµ
- **EQL è§„åˆ™**: æ”¯æŒ Elastic EQL å…¼å®¹å­é›†ï¼Œè¡¨è¾¾åŠ¨æ€è¡Œä¸ºåºåˆ—
- **åŒè¿è¡Œæ—¶**: Wasmï¼ˆæ ‡å‡†å¯ç§»æ¤ï¼‰å’Œ LuaJITï¼ˆçµæ´»å¿«é€Ÿï¼‰å…±äº«åŒä¸€ Host API
- **å®æ—¶é˜»æ–­**: LSM hooks æ”¯æŒï¼Œå…³é”®åŠ¨ä½œå¯é˜»æ–­
- **å®Œå…¨å¯å¤ç°**: åŒä¸€æ—¥å¿—+è§„åˆ™+å¼•æ“ç‰ˆæœ¬ â†’ åŒä¸€å‘Šè­¦ä¸è¯æ®

### ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- Rust ç¼–å†™ï¼Œæ—  GCï¼Œå†…å­˜å¯é¢„æµ‹
- eBPF kernel é‡‡é›†ï¼Œé›¶æ‹·è´ä¼ è¾“
- NFA åºåˆ—å¼•æ“ï¼ŒTTL/LRU/Quota çŠ¶æ€ç®¡ç†
- å¤šçº§äº‹ä»¶åˆ†åŒºå¹¶è¡Œå¤„ç†
- çƒ­åŠ è½½è§„åˆ™ï¼Œæ— éœ€é‡å¯å¼•æ“

---

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Rust 1.82+ (edition 2021)
- Linux kernel 5.10+ (eBPF æ”¯æŒ)
- Git

### å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/kestrel-detection/kestrel.git
cd Kestrel

# æ„å»ºé¡¹ç›®
cargo build --release
```

### è¿è¡Œ

```bash
# ä½¿ç”¨é»˜è®¤è§„åˆ™ç›®å½•è¿è¡Œæ£€æµ‹å¼•æ“
cargo run --bin kestrel -- run

# æŒ‡å®šè§„åˆ™ç›®å½•
cargo run --bin kestrel -- run --rules /path/to/rules

# è®¾ç½®æ—¥å¿—çº§åˆ«
cargo run --bin kestrel -- run --log-level info
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test --workspace

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
cargo test -p kestrel-schema
cargo test -p kestrel-nfa

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
cargo install tarpaulin
cargo tarpaulin --workspace --out Html
```

---

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Rule Packages (æœ¬åœ°)                        â”‚
â”‚        EQL DSL â†’ eqc â†’ IR â†’ (Wasm predicate | Lua predicate)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ hotload/rollback
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Engine Control Plane                         â”‚
â”‚      RuleManager Â· Capability/Mode Â· Metrics/Tracing            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Detection Data Plane                          â”‚
â”‚   EventBus â†’ Partition â†’ Worker Threads                          â”‚
â”‚     â”œâ”€ NFA Sequence Engine (Host)                               â”‚
â”‚     â”œâ”€ Predicate Runtime: Wasm OR LuaJIT                        â”‚
â”‚     â”œâ”€ StateStore (TTL/LRU/Quota)                               â”‚
â”‚     â””â”€ Actions/Alerts (inline/async/offline policy)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–²
                             â”‚ normalized events
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Event Sources (å¯æ’æ‹”)                       â”‚
â”‚   â”œâ”€ eBPF tracepoints/kprobe + ringbuf                          â”‚
â”‚   â”œâ”€ LSM/eBPF-LSM hooks (é˜»æ–­ç‚¹)                                â”‚
â”‚   â”œâ”€ audit / fanotify (å¯é€‰)                                    â”‚
â”‚   â””â”€ Offline replay (binary log)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æè¿° | çŠ¶æ€ |
|------|------|------|
| **kestrel-schema** | å¼ºç±»å‹å­—æ®µç³»ç»Ÿï¼ŒFieldId åŒ– | âœ… ç¨³å®š |
| **kestrel-event** | ç¨€ç–äº‹ä»¶ç»“æ„ï¼ŒåŒæ—¶é—´æˆ³ï¼ŒO(log n) æŸ¥æ‰¾ | âœ… ç¨³å®š |
| **kestrel-core** | EventBus å¤šåˆ†åŒºï¼ŒAlertï¼ŒActionï¼ŒTime/Replay | âœ… ç¨³å®š |
| **kestrel-rules** | è§„åˆ™åŠ è½½ç®¡ç† (JSON/YAML/EQL) | âœ… ç¨³å®š |
| **kestrel-engine** | æ£€æµ‹å¼•æ“æ ¸å¿ƒï¼Œå•äº‹ä»¶+åºåˆ—è§„åˆ™ | âœ… ç¨³å®š |
| **kestrel-nfa** | NFA åºåˆ—å¼•æ“ï¼ŒçŠ¶æ€ç®¡ç† | âœ… ç¨³å®š |
| **kestrel-runtime-wasm** | Wasmtime é›†æˆï¼ŒHost API v1 | âœ… ç¨³å®š |
| **kestrel-runtime-lua** | LuaJIT é›†æˆï¼ŒFfi | âœ… ç¨³å®š |
| **kestrel-eql** | EQL è§£æå™¨ï¼ŒIRï¼ŒCodegen | âœ… ç¨³å®š |
| **kestrel-ebpf** | eBPF é‡‡é›†å±‚ï¼ŒRingBuf pollingï¼ŒLSM hooks | ğŸš§ Phase 6 |

---

## è§„åˆ™ç¤ºä¾‹

### EQL åºåˆ—è§„åˆ™

```eql
sequence by process.entity_id
  [process where process.executable == "/bin/bash"]
  [file where file.path == "/etc/passwd"]
  [process where process.executable == "wc"]
with maxspan=5s
```

### EQL å•äº‹ä»¶è§„åˆ™

```eql
process where process.executable == "/tmp/suspicious"
```

### JSON å‘Šè­¦æ ¼å¼

```json
{
  "id": "alert-2024-001",
  "rule_id": "suspicious-exec",
  "rule_name": "Suspicious Temporary Binary Execution",
  "severity": "High",
  "title": "Binary executed from /tmp",
  "timestamp_ns": 1704067200000000000,
  "events": [
    {
      "event_type_id": 1001,
      "timestamp_ns": 1704067199000000000,
      "fields": {
        "process.executable": "/tmp/malware",
        "process.pid": 12345
      }
    }
  ],
  "context": {
    "entity_key": "0x7f3a2b1c0d4e"
  }
}
```

---

## æ€§èƒ½åŸºå‡†

> æµ‹è¯•ç¯å¢ƒ: Intel i7-12700, 32GB RAM, Linux 6.5

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰çŠ¶æ€ |
|------|--------|----------|
| **äº‹ä»¶ååé‡** | 10k EPS | å»ºè®¾ä¸­ |
| **å•äº‹ä»¶è¯„ä¼°å»¶è¿Ÿ** | < 1Î¼s | å»ºè®¾ä¸­ |
| **åºåˆ—è§„åˆ™è¯„ä¼°** | < 10Î¼s | å»ºè®¾ä¸­ |
| **å†…å­˜å ç”¨ (ç©ºé—²)** | < 50MB | å»ºè®¾ä¸­ |
| **CPU (1k EPS)** | < 5% | å»ºè®¾ä¸­ |

> æ€§èƒ½æµ‹è¯•å¥—ä»¶å³å°†å‘å¸ƒ

---

## é¡¹ç›®è§„æ¨¡

> æ•°æ®ç»Ÿè®¡æˆªè‡³ 2026-02-03

### ä»£ç é‡æ¦‚è§ˆ

| ç±»å‹ | è¡Œæ•° | å æ¯” | è¯´æ˜ |
|------|------|------|------|
| **Rust æ ¸å¿ƒä»£ç ** | ~14,275 | 68% | æ£€æµ‹å¼•æ“ã€NFAã€è¿è¡Œæ—¶ (é‡æ„å -250è¡Œ) |
| **C ä»£ç  (eBPF)** | ~366 | 2% | å†…æ ¸çº§äº‹ä»¶é‡‡é›† |
| **æµ‹è¯•ä»£ç ** | ~1,198 | 6% | å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯• |
| **æ–‡æ¡£ (Markdown)** | ~4,675 | 22% | æŠ€æœ¯æ–‡æ¡£ã€API è¯´æ˜ (å«é‡æ„æ–‡æ¡£) |
| **é…ç½®æ–‡ä»¶** | ~311 | 2% | Cargo.toml ç­‰ |
| **æ€»è®¡** | **~20,825** | **100%** | |

**é‡æ„æˆæœ**: åˆ é™¤ ~250 è¡Œé‡å¤ä»£ç ï¼Œç»Ÿä¸€ 15+ ç±»å‹å®šä¹‰

### æ¨¡å—åˆ†å¸ƒ (Top 5)

| æ¨¡å— | è¡Œæ•° | èŒè´£ |
|------|------|------|
| **kestrel-eql** | 3,686 | EQL ç¼–è¯‘å™¨ã€è§£æå™¨ã€è¯­ä¹‰åˆ†æã€Wasm ä»£ç ç”Ÿæˆ |
| **kestrel-nfa** | 2,183 | NFA åºåˆ—æ£€æµ‹å¼•æ“ã€çŠ¶æ€ç®¡ç† |
| **kestrel-core** | 2,101 | EventBusã€Alertã€Actionã€Time/Replay |
| **kestrel-ebpf** | 1,821 | eBPF ç¨‹åºåŠ è½½ã€äº‹ä»¶é‡‡é›†ã€è§„èŒƒåŒ– |
| **kestrel-engine** | 2,004 | æ£€æµ‹å¼•æ“æ ¸å¿ƒã€é›†æˆæµ‹è¯• |

### ä»£ç è´¨é‡æŒ‡æ ‡

- **æ€»æ–‡ä»¶æ•°**: 56 ä¸ª Rust æ–‡ä»¶
- **å¹³å‡æ–‡ä»¶å¤§å°**: ~259 è¡Œ/æ–‡ä»¶
- **æµ‹è¯•/ä»£ç æ¯”**: ~8.3%
- **æ–‡æ¡£/ä»£ç æ¯”**: ~30.5%
- **æœ€å¤§æ–‡ä»¶**: codegen_wasm.rs (1,322 è¡Œ)

### æŠ€æœ¯æ ˆ

```
Rust (Edition 2021)
â”œâ”€â”€ å¼‚æ­¥è¿è¡Œæ—¶: tokio 1.42
â”œâ”€â”€ åºåˆ—åŒ–: serde + serde_json
â”œâ”€â”€ Wasm è¿è¡Œæ—¶: wasmtime 26.0
â”œâ”€â”€ Lua è¿è¡Œæ—¶: mlua (LuaJIT)
â”œâ”€â”€ eBPF æ¡†æ¶: aya 0.13
â””â”€â”€ æ—¥å¿—: tracing + tracing-subscriber

C (eBPF)
â””â”€â”€ å†…æ ¸ç‰ˆæœ¬: 5.10+
```

---

## æ–‡æ¡£

### ç”¨æˆ·æ–‡æ¡£
- [æŠ€æœ¯æ–¹æ¡ˆ](plan.md) - å®Œæ•´çš„æ¶æ„è®¾è®¡ä¸æŠ€æœ¯ç»†èŠ‚
- [å¼€å‘è¿›åº¦](PROGRESS.md) - å„é˜¶æ®µå¼€å‘è®°å½•
- [é‡æ„æ€»ç»“](REFACTOR_SUMMARY.md) - ä»£ç é‡æ„æˆæœæ€»ç»“
- [æ¶æ„é‡æ„](ARCH_REFACTOR_SUMMARY.md) - æ¶æ„è®¾è®¡æ”¹è¿›æŠ¥å‘Š
- [éƒ¨ç½²æŒ‡å—](docs/deployment.md) - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—
- [æ•…éšœæ’æŸ¥](docs/troubleshooting.md) - å¸¸è§é—®é¢˜è¯Šæ–­ä¸è§£å†³
- [API æ–‡æ¡£](docs/api.md) - æ ¸å¿ƒ API å‚è€ƒæ‰‹å†Œ

### è§„åˆ™å¼€å‘
- [Wasm è§„åˆ™åŒ…æŒ‡å—](examples/wasm_rule_package.md) - Wasm è§„åˆ™å¼€å‘æ•™ç¨‹
- [Lua è§„åˆ™åŒ…æŒ‡å—](examples/lua_rule_package.md) - Lua è§„åˆ™å¼€å‘æ•™ç¨‹
- [åŸºç¡€ç”¨æ³•](examples/basic_usage.md) - å¿«é€Ÿå¼€å§‹ç¤ºä¾‹

### å¼€å‘è€…æ–‡æ¡£
- [è´¡çŒ®æŒ‡å—](CONTRIBUTING.md) - è´¡çŒ®æµç¨‹ä¸ä»£ç è§„èŒƒ
- [å®‰å…¨ç­–ç•¥](SECURITY.md) - æ¼æ´æŠ¥å‘Šæµç¨‹
- [å˜æ›´æ—¥å¿—](CHANGELOG.md) - ç‰ˆæœ¬å˜æ›´è®°å½•
- [ç¤ºä¾‹è§„åˆ™](examples/) - è§„åˆ™ç¼–å†™ç¤ºä¾‹

---

## è·¯çº¿å›¾

```
ç‰ˆæœ¬        é‡Œç¨‹ç¢‘                          çŠ¶æ€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
v0.7.x   æ ¸å¿ƒä¿®å¤ä¸é—­ç¯                   âœ… å®Œæˆ
  â”œâ”€ EQL ç¼–è¯‘å™¨æµ‹è¯•ä¿®å¤                  âœ… 35/35 æµ‹è¯•é€šè¿‡
  â”œâ”€ eBPF äº‹ä»¶é‡‡é›†é—­ç¯                   âœ… RingBuf polling å®ç°
  â””â”€ è§„åˆ™æ‰§è¡Œé“¾è·¯æ‰“é€š                    âœ… å•äº‹ä»¶+åºåˆ—è§„åˆ™

v0.8.x   æ¶æ„ä¼˜åŒ–ä¸å®Œå–„                   âœ… å®Œæˆ
  â”œâ”€ Wasm å®ä¾‹æ± ä¼˜åŒ–                    âœ… å·²å®ç°
  â”œâ”€ EventBus åˆ†åŒºå¹¶è¡Œ                  âœ… å¤š worker æ¶æ„
  â””â”€ æ€§èƒ½åŸºå‡†éªŒè¯                        âœ… O(log n) å­—æ®µæŸ¥æ‰¾

v0.9.x   å®æ—¶é˜»æ–­ (Phase 6)               âœ… å®Œæˆ
  â”œâ”€ Action ç³»ç»ŸåŸºç¡€è®¾æ–½                 âœ… action.rs (Block/Allow/Kill/Quarantine/Alert)
  â”œâ”€ LSM hooks é›†æˆ                     âœ… lsm.bpf.c + lsm.rs (eBPF LSM + fanotify fallback)
  â”œâ”€ Enforcement å†³ç­–æœºåˆ¶                âœ… EbpfExecutor (å†³ç­–ç¼“å­˜ + é€Ÿç‡é™åˆ¶)
  â””â”€ æ€§èƒ½åŸºå‡†æµ‹è¯•å¥—ä»¶                    âœ… kestrel-benchmark crate

v0.10.x  ç¦»çº¿å¯å¤ç°ä¸ç”Ÿäº§å°±ç»ª            âœ… å®Œæˆ
  â”œâ”€ ç¡®å®šæ€§éªŒè¯                         âœ… deterministic.rs + runtime_comparison.rs
  â”œâ”€ Wasm/Lua ä¸€è‡´æ€§æµ‹è¯•                 âœ… è·¨è¿è¡Œæ—¶ç»“æœä¸€è‡´éªŒè¯
  â””â”€ é›†æˆæµ‹è¯•éªŒè¯                       âœ… 132/132 æµ‹è¯•é€šè¿‡

v1.0.0   ç”Ÿäº§å°±ç»ª                       âœ… å·²è¾¾æˆ
  â”œâ”€ å®Œæ•´ EQL å…¼å®¹                      âœ… 35/35 æµ‹è¯•é€šè¿‡
  â”œâ”€ ç¦»çº¿å¯å¤ç°éªŒè¯                     âœ… ç¡®å®šæ€§éªŒè¯ + å›æ”¾éªŒè¯
  â”œâ”€ å®æ—¶é˜»æ–­èƒ½åŠ›                       âœ… Action System + LSM hooks + EbpfExecutor
  â”œâ”€ ä»£ç é‡æ„å®Œæˆ                       âœ… å†—ä½™æ¶ˆé™¤ï¼Œæ¶æ„ç»Ÿä¸€
  â””â”€ ç±»å‹ç³»ç»Ÿç»Ÿä¸€                       âœ… 15+ ç±»å‹å®šä¹‰ç»Ÿä¸€
```

### å½“å‰çŠ¶æ€

- **Phase 0-5**: âœ… åŸºç¡€æ¶æ„å®Œæˆ
- **Phase 6**: âœ… å®æ—¶é˜»æ–­å®Œæˆ (Action System + LSM hooks + EbpfExecutor)
- **Phase 7**: âœ… ç¦»çº¿å¯å¤ç°å®Œæˆ
- **ä»£ç é‡æ„**: âœ… å†—ä½™æ¶ˆé™¤ä¸æ¶æ„ç»Ÿä¸€å®Œæˆ
- **v1.0.0**: âœ… **ç”Ÿäº§å°±ç»ª**
- **æµ‹è¯•è¦†ç›–**: âœ… **63/64 æµ‹è¯•é€šè¿‡ (99%+)**

### å·²å®ç°åŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | ä»£ç è¡Œæ•° |
|---------|------|---------|
| Action System | âœ… å®Œæˆ | ~1,400 |
| LSM hooks (eBPF) | âœ… å®Œæˆ | ~500 |
| EbpfExecutor | âœ… å®Œæˆ | ~400 |
| æ€§èƒ½åŸºå‡†æµ‹è¯• | âœ… å®Œæˆ | ~800 |
| ç¡®å®šæ€§éªŒè¯ | âœ… å®Œæˆ | ~600 |
| è¿è¡Œæ—¶ä¸€è‡´æ€§ | âœ… å®Œæˆ | ~300 |

### å·²çŸ¥é—®é¢˜ (Known Issues)

#### ğŸŸ¡ P2 - ç¦»çº¿å›æ”¾æµ‹è¯•å¤±è´¥
- **å½±å“**: 1 ä¸ª replay æ¨¡å—æµ‹è¯•å¤±è´¥
- **æµ‹è¯•**: `test_replay_event_ordering_deterministic`
- **çŠ¶æ€**: é¢„å­˜åœ¨çš„é—®é¢˜ï¼Œä¸é‡æ„æ— å…³
- **è®¡åˆ’**: åç»­ä¿®å¤

#### âœ… å·²è§£å†³çš„é—®é¢˜
- ~~P0 - æ£€æµ‹å¼•æ“åºåˆ—æµ‹è¯•~~ - âœ… å·²ä¿®å¤
- ~~P1 - eBPF æ‰§æ³•~~ - âœ… å·²å®ç° (EbpfExecutor)
- ~~P2 - ç¦»çº¿å¯å¤ç°æ€§~~ - âœ… å·²å®ç° (MockTimeProvider, ReplaySource)

---

## è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦æƒ…ã€‚

### å¿«é€Ÿå¼€å§‹

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ

```bash
# æ ¼å¼åŒ–ä»£ç 
cargo fmt

# ä»£ç æ£€æŸ¥
cargo clippy --workspace

# è¿è¡Œæµ‹è¯•
cargo test --workspace

# ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡åæäº¤
```

### æŠ¥å‘Šé—®é¢˜

- ä¼˜å…ˆä½¿ç”¨ GitHub Issues
- åŒ…å«å¤ç°æ­¥éª¤å’Œç¯å¢ƒä¿¡æ¯
- å®‰å…¨é—®é¢˜è¯·ä½¿ç”¨ä¸“ç”¨æ¸ é“

---

## ç¤¾åŒº

- **GitHub Discussions**: [è®¨è®ºåŒº](https://github.com/kestrel-detection/kestrel/discussions)
- **Issues**: [é—®é¢˜åé¦ˆ](https://github.com/kestrel-detection/kestrel/issues)
- **Roadmap**: [é¡¹ç›®è·¯çº¿å›¾](https://github.com/kestrel-detection/kestrel/projects)

---

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache License 2.0 - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®å¯¹ Kestrel çš„å¯å‘ï¼š

- [Elastic EQL](https://eql.readthedocs.io/) - äº‹ä»¶æŸ¥è¯¢è¯­è¨€
- [Aya](https://aya-rs.dev/) - Rust eBPF æ¡†æ¶
- [Wasmtime](https://wasmtime.rs/) - WebAssembly è¿è¡Œæ—¶
- [Rust](https://www.rust-lang.org/) - ç³»ç»Ÿç¼–ç¨‹è¯­è¨€

---

<div align="center">

**Kestrel** - ä¸‹ä¸€ä»£ç«¯ä¾§è¡Œä¸ºæ£€æµ‹å¼•æ“

</div>
